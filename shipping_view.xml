<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <!-- Top menu item -->
        <menuitem name="FnxSR" id="menu_fnx_sr_root" groups="group_fnx_sr_manager,group_fnx_sr_user,group_fnx_sr_guest"/>

        <record model="ir.ui.view" id="fnx_sr_calendar">
            <field name="name">fnx.sr.calendar</field>
            <field name="model">fnx.sr.shipping</field>
            <field name="priority" eval="10"/>
            <field name="arch" type="xml">
                <calendar string="Calendar View" color="state" date_start="appointment">
                    <field name="name"/>
                    <field name="partner_id"/>
                    <field name="partner_source_document"/>
                    <field name="carrier_id"/>
                </calendar>
            </field>
        </record>

        <record model="ir.ui.view" id="fnx_sr_tree">
            <field name="name">fnx.sr.tree</field>
            <field name="model">fnx.sr.shipping</field>
            <field name="priority" eval="10"/>
            <field name="arch" type="xml">
                <tree string="Tree View" toolbar="1" create="false">
                    <field name="direction"/>
                    <field name="carrier_id"/>
                    <field name="appointment"/>
                    <field name="pallets"/>
                    <field name="name"/>
                    <field name="partner_id"/>
                    <field name="partner_source_document"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="fnx_sr_form">
            <field name="name">fnx.sr.form</field>
            <field name="model">fnx.sr.shipping</field>
            <field name="priority" eval="10"/>
            <field name="arch" type="xml">
                <form string="Shipping &amp; Receiving" version="7.0" create="false">
                    <header>
                        <field name="state" widget="statusbar" statusbar_visible="draft,scheduled,ready,complete" />
                    </header>
                    <sheet>
                        <group>
                            <group>
                                <div>
                                    <h1>
                                        <field name="name" attrs="{'readonly':True}"/>
                                    </h1>
                                    <h3>
                                        <field name="direction" class="oe_inline" attrs="{'readonly':True}"/>
                                        <field name="partner_source_document" class="oe_inline" attrs="{'invisible':[('partner_source_document','=',False)], 'readonly':True}"/>
                                        via
                                        <field name="carrier_id" class="oe_inline" options="{'create':False, 'create_edit':False, 'limit':15}"/>
                                        <field name="preposition" class="oe_inline" attrs="{'readonly':True}"/>
                                        <field name="partner_id" class="oe_inline" attrs="{'readonly':True}" options="{'create':False, 'create_edit':False, 'limit':0}"/>
                                        <p>
                                            Order placed by
                                            <field name="job_title" class="oe_inline" attrs="{'readonly':True}"/>
                                            <field name="local_contact_id" class="oe_inline" attrs="{'readonly':[('is_manager','=',False)]}"/>
                                        </p>
                                    </h3>
                                </div>
                                <div class="oe_right oe_button_box">
                                    <button string="Driver Check-In" groups="fnx_sr.group_fnx_sr_user" name="sr_checkin" states="draft,scheduled,appt,ready" type="object" atts="{readonly':True}"/>
                                    <button string="Driver Check-Out" groups="fnx_sr.group_fnx_sr_user" name="sr_complete" states="checked_in" type="object" atts="{readonly':True}"/>
                                </div>
                            </group>
                        </group>
                        <group>
                            <group>
                                <field name="appointment_date" class="oe_inline"/>
                                <field name="appointment_time" class="oe_inline" widget="float_time"/>
                                <separator colspan="2"/>
                                <field name="check_in" attrs="{'readonly':[('is_manager','=',False)]}"/>
                                <field name="check_out" attrs="{'readonly':[('is_manager','=',False)]}"/>
                                <field name="duration" widget="float_time"/>
                            </group>
                            <group>
                                <field name="weight" attrs="{'readonly':True}"/>
                                <field name="cartons" attrs="{'readonly':True}"/>
                                <field name="pallets" attrs="{'readonly':True}"/>
                                <separator colspan="2"/>
                                <field name="appt_scheduled_by_id" attrs="{'readonly':[('is_manager','=',False)]}"/>
                                <field name="appt_confirmed_on" attrs="{'readonly':[('is_manager','=',False)]}"/>
                                <field name="is_manager" attrs="{'invisible':True}"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Warehouse Comments">
                                <field name="warehouse_comment" nolabel="1" attrs="{'readonly':True}"/>
                            </page>
                            <page string="Order Comments">
                                <field name="comment"/>
                            </page>
                            <page string="Manager Overrides" attrs="{'invisible':[('is_manager','=',False)]}">
                                <separator string="Reset state to"/>
                                <button string="Order Placed" name="sr_draft" type="object" context="{'manager_override':True}"/>
                                <button string="Scheduled" name="sr_schedule" type="object" context="{'manager_override':True}"/>
                                <button string="Ready, needs Appt" name='sr_appointment' type="object" context="{'manager_override':True}"/>
                                <button string="Ready" name="sr_ready" type="object" context="{'manager_override':True}"/>
                                <button string="Checked-In" name="sr_checkin" type="object" context="{'manager_override':True}"/>
                                <button string="Complete" name="sr_complete" type="object" context="{'manager_override':True}"/>
                                <button string="Cancelled" name="sr_cancel" type="object" context="{'manager_override':True}"/>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread" nolabel="1" />
                    </div>
                </form>
            </field>
        </record>

        <record model="ir.ui.view" id="view_fnx_sr_driver_checkin">
            <field name="name">Check-in Driver</field>
            <field name="model">fnx.sr.shipping</field>
            <field name="arch" type="xml">
                <form string="Check-in Driver" version="7.0">
                    <separator colspan="4" string="Check in driver for selected orders?"/>
                    <footer>
                        <button name="more_checkin" string="Check-In" type="object" />
                    </footer>
                </form>
            </field>
        </record>

        <record model="ir.actions.act_window" id="action_fnx_sr_driver_checkin">
            <field name="name">Check-in Driver</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">fnx.sr.shipping.checkin</field>
            <field name="view_type">form</field>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_fnx_sr_driver_checkin"/>
            <field name="target">new</field>
            <field name="multi">True</field>
        </record>

        <record model="ir.values" id="event_fnx_sr_driver_checkin">
            <field name="name">Open Driver Check-In Form</field>
            <field name="model_id" ref="fnx_sr.model_fnx_sr_shipping"/>
            <field name="value" eval="'ir.actions.act_window,' + str(ref('action_fnx_sr_driver_checkin'))"/>
            <field name="key">action</field>
            <field name="key2">client_action_multi</field>
            <field name="model">fnx.sr.shipping</field>
        </record>

        <record model="ir.ui.view" id="view_fnx_sr_driver_checkout">
            <field name="name">Check-out Driver</field>
            <field name="model">fnx.sr.shipping</field>
            <field name="arch" type="xml">
                <form string="Check-out Driver" version="7.0">
                    <separator colspan="4" string="Check out driver for selected orders?"/>
                    <footer>
                        <button name="more_checkout" string="Check-Out" type="object" />
                    </footer>
                </form>
            </field>
        </record>

        <record model="ir.actions.act_window" id="action_fnx_sr_driver_checkout">
            <field name="name">Check-out Driver</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">fnx.sr.shipping.checkout</field>
            <field name="view_type">form</field>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_fnx_sr_driver_checkout"/>
            <field name="target">new</field>
            <field name="multi">True</field>
        </record>

        <record model="ir.values" id="event_fnx_sr_driver_checkout">
            <field name="name">Open Driver Check-Out Form</field>
            <field name="model_id" ref="fnx_sr.model_fnx_sr_shipping"/>
            <field name="value" eval="'ir.actions.act_window,' + str(ref('action_fnx_sr_driver_checkout'))"/>
            <field name="key">action</field>
            <field name="key2">client_action_multi</field>
            <field name="model">fnx.sr.shipping</field>
        </record>

        <record model="ir.ui.view" id="search_fnx_sr_open_orders">
            <field name="name">Open Orders Search</field>
            <field name="model">fnx.sr.shipping</field>
            <field name="arch" type="xml">
                <search string="Search Shipping &amp; Receiving">
                    <field name="state" string="Status" />
                    <field name="local_source_document" string="Local Document" />
                    <field name="partner_source_document" string="Partner Document" />
                    <separator/>
                    <filter string="Order Placed" name="type_draft" domain="[('state','=','draft')]"/>
                    <filter string="Scheduled" name="type_scheduled" domain="[('state','=','scheduled')]"/>
                    <filter string="Ready, Needs Appt" name="type_appt" domain="[('state','=','appt')]"/>
                    <filter string="Ready" name="type_ready" domain="[('state','=','ready')]"/>
                    <filter string="Driver checked-in" name="type_checked_in" domain="[('state','=','checked_in')]"/>
                    <separator/>
                    <filter string="Shipping" name="type_shipping" domain="[('direction','=','outgoing')]"/>
                    <filter string="Receiving" name="type_receiving" domain="[('direction','=','incoming')]"/>
                    <separator/>
                    <group expand="0" string="Group by...">
                        <filter string="Carrier" domain="[]" context="{'group_by': 'carrier_id'}"/>
                        <filter string="Customer/Vendor" domain="[]" context="{'group_by': 'partner_id'}"/>
                    </group>
                </search>
            </field>
        </record>

        <record model="ir.ui.view" id="search_fnx_sr_closed_orders">
            <field name="name">Closed Orders Search</field>
            <field name="model">fnx.sr.shipping</field>
            <field name="arch" type="xml">
                <search string="Search Shipping &amp; Receiving">
                    <field name="state" string="Status" />
                    <field name="local_source_document" string="Local Document" />
                    <field name="partner_source_document" string="Partner Document" />
                    <separator/>
                    <filter string="Cancelled" name="type_cancelled" domain="[('state','=','cancelled')]"/>
                    <filter string="Complete" name="type_complete" domain="[('state','=','complete')]"/>
                    <separator/>
                    <filter string="Shipping" name="type_shipping" domain="[('direction','=','outgoing')]"/>
                    <filter string="Receiving" name="type_receiving" domain="[('direction','=','incoming')]"/>
                    <separator/>
                    <group expand="0" string="Group by...">
                        <filter string="Carrier" domain="[]" context="{'group_by': 'carrier_id'}"/>
                        <filter string="Customer/Vendor" domain="[]" context="{'group_by': 'partner_id'}"/>
                    </group>
                </search>
            </field>
        </record>

        <record model="ir.ui.view" id="search_fnx_sr_all_orders">
            <field name="name">All Orders Search</field>
            <field name="model">fnx.sr.shipping</field>
            <field name="arch" type="xml">
                <search string="Search Shipping &amp; Receiving">
                    <field name="state" string="Status" />
                    <field name="local_source_document" string="Local Document" />
                    <field name="partner_source_document" string="Partner Document" />
                    <separator/>
                    <filter string="Order Placed" name="type_draft" domain="[('state','=','draft')]"/>
                    <filter string="Scheduled" name="type_scheduled" domain="[('state','=','scheduled')]"/>
                    <filter string="Ready, Needs Appt" name="type_appt" domain="[('state','=','appt')]"/>
                    <filter string="Ready" name="type_ready" domain="[('state','=','ready')]"/>
                    <filter string="Driver checked-in" name="type_checked_in" domain="[('state','=','checked_in')]"/>
                    <filter string="Cancelled" name="type_cancelled" domain="[('state','=','cancelled')]"/>
                    <filter string="Complete" name="type_complete" domain="[('state','=','complete')]"/>
                    <separator/>
                    <filter string="Shipping" name="type_shipping" domain="[('direction','=','outgoing')]"/>
                    <filter string="Receiving" name="type_receiving" domain="[('direction','=','incoming')]"/>
                    <separator/>
                    <group expand="0" string="Group by...">
                        <filter string="Carrier" domain="[]" context="{'group_by': 'carrier_id'}"/>
                        <filter string="Customer/Vendor" domain="[]" context="{'group_by': 'partner_id'}"/>
                    </group>
                </search>
            </field>
        </record>

        <record model="ir.actions.act_window" id="action_fnx_sr_form_open_orders">
            <field name="name">Shipping &amp; Receiving - Open Orders</field>
            <field name="res_model">fnx.sr.shipping</field>
            <field name="view_type">form</field>
            <field name="view_id" ref="fnx_sr_tree"/>
            <field name="view_mode">tree,form,calendar</field>
            <field name="domain" eval="[('state','in',['draft','scheduled','appt','ready','checked_in'])]"/>
            <field name="search_view_id" ref="search_fnx_sr_open_orders"/>
            <field name="limit" eval="1000"/>
        </record>

        <record model="ir.actions.act_window" id="action_fnx_sr_form_closed_orders">
            <field name="name">Shipping &amp; Receiving - Closed Orders</field>
            <field name="res_model">fnx.sr.shipping</field>
            <field name="view_type">form</field>
            <field name="view_id" ref="fnx_sr_tree"/>
            <field name="view_mode">tree,form,calendar</field>
            <field name="domain" eval="[('state','in',['cancelled','complete'])]"/>
            <field name="search_view_id" ref="search_fnx_sr_closed_orders"/>
            <field name="limit" eval="1000"/>
        </record>

        <record model="ir.actions.act_window" id="action_fnx_sr_form_all_orders">
            <field name="name">Shipping &amp; Receiving - All Orders</field>
            <field name="res_model">fnx.sr.shipping</field>
            <field name="view_type">form</field>
            <field name="view_id" ref="fnx_sr_tree"/>
            <field name="view_mode">tree,form,calendar</field>
            <field name="search_view_id" ref="search_fnx_sr_all_orders"/>
            <field name="limit" eval="1000"/>
        </record>

        <menuitem
            name="Shipping &amp; Receiving"
            id="menu_fnx_sr_shipping"
            parent="menu_fnx_sr_root"
            sequence="10"
            />

        <menuitem
            name="Open Orders"
            id="menu_item_fnx_sr_schedule_open"
            parent="menu_fnx_sr_shipping"
            sequence="20"
            action="action_fnx_sr_form_open_orders"
            />

        <menuitem
            name="Closed Orders"
            id="menu_item_fnx_sr_schedule_closed"
            parent="menu_fnx_sr_shipping"
            sequence="30"
            action="action_fnx_sr_form_closed_orders"
            />

        <menuitem
            name="All Orders"
            id="menu_item_fnx_sr_schedule_all"
            parent="menu_fnx_sr_shipping"
            sequence="40"
            action="action_fnx_sr_form_all_orders"
            />

    </data>
</openerp>
